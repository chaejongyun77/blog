# 진행 배경
> "JWT토큰을 활용하여 보안성을 높여보자"

기존 시스템에서는  
**세션 + JWT Access Token** 조합을 사용해 로그인 상태를 유지하고 있었다.

Access Token을 통해 사용자를 식별하되,
세션을 함께 사용하면서 서버 측에서도 로그인 상태를 관리하는 구조였다.

하지만 최근 여러 기업에서 발생한 개인정보 유출 사고와
인증·인가 취약점 이슈를 계기로,
로그인 보안 구조 전반을 다시 점검할 필요가 있다고 판단했다.

특히 세션 기반 상태 관리와
만료 제어가 어려운 Access Token 단독 사용 방식은
보안과 확장성 측면에서 한계가 명확했다.

이러한 문제를 개선하기 위해
기존 세션 구조를 제거하고,
**JWT Access Token + Refresh Token + Redis** 기반의
로그인 로직으로 인증 구조를 재설계했다.

***
<br>

# JWT토큰이란 무엇인가?
**JWT(Json Web Token)** 은 Json 객체에 인증에 필요한 정보들을 담은 후 **비밀키로 서명한 토큰**으로 인터넷 표준 인증 방식이다. 

<br>

## JWT토큰 프로세스

![
다운로드 성공
](./img/jwt/token3.png)

- 사용자가 아이디와 비밀번호를 입력하여 서버에 로그인 요청
- 서버는 비밀키를 사용해 JSON payload에 서명(Signature)을 추가한 JWT 토큰을 생성
- Response body로 JWT토큰 전달
- 이후 API요청시 헤더에 JWT 토큰을 포함
- 서버에서 JWT검증 후 API 요청 처리

## 현재 로그인 프로세스의 문제점 분석
>JWT토큰도 안전한게 아니다

1. Access Token만 사용하는 한계   

현재 로그인 구조에서는 **Access Token 하나만 발급하여 인증**을 처리하고 있습니다.   
보안을 위해 유효시간을 무제한으로 두지 않고 4시간으로 설정해두었지만 만약에 토큰이 탈취당할 경우 해당 유효시간 동안은 **누구든 API를 접근할 수 있다는 문제점**이 있었습니다.
또한 탈취를 당하더라도 서버쪽에서 토큰관련 정보를 저장해두지 않았기 때문에 강제로 로그아웃도 시킬 수 없는 상황이여서 보안에 취약했습니다.   
즉 Access Token 하나로 로그인 상태를 유지하는 구조는 보안적인 사고가 발생했을 시 대응할 수 있는 수단이 거의 없었습니다.

2. JWT Payload에 포함된 불필요한 사용자 정보   

JWT는 Response body를 통해 서버에서 클라이언트로 전달되며 이때 JWT의 Payload에는 다음과 같은 사용자 정보가 포함되어 있었습니다.
- 사용자 ID
- 닉네임
- 사용자 권한값
- 사용자 타입
- 접속일자
- 기타 사용자 정보등
   
따라서 만약 토큰이 유출될 경우 개인정보가 노출이 되고 내부 시스템의 구조를 유추할 수 있는 수단이 될 수도 있습니다.   
또한 이렇게 불필요한 사용자 정보를 Access Token에 저장하면 JWT 토큰의 크기가 증가하고 API 요청 시 쿠키가 자동으로 헤더에 포함되어 전송될때 크기 증가로 이한 트래픽 및 성능에 영향을 끼칠 수도 있을 거 같다는 생각을 했습니다.

3. Access Token을 쿠키에 Base64 형태로 저장   

Access Token 값을 쿠키에 Base64형태로 저장하다보니 누구나 개발자도구를 통해 Access Token 값을 찾아낸 후 디코딩을 할 수 있었습니다.   
물론 값을 한 눈에 알아보기 쉬운 형태는 아니었지만 마음먹고 토큰을 탈취하려고 하는 사람들에겐 디코딩하기 쉬운 값들이므로 보안에 취약점이 있었습니다.

<br>

## 그래서 어떻게 보안에 신경을 썻는가?
<br>




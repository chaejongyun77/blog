# 실시간 메시징이 중요해?
현재 나는 선생님과 학생이 같은 화면을 보며 실시간으로 소통할 수 있는 웹 기반 전자칠판 서비스를 개발·운영하고 있다.

전자칠판 서비스에서 실시간 메시징은 선택이 아니라 필수다.

선생님이 전자칠판에 글을 작성하거나 도형을 추가하고요소를 이동·삭제하는 순간 그 변화가 학생들의 화면에도 즉시 반영되어야 실제 수업과 같은 의사소통이 가능해지기 때문이다.

즉, 한 사용자의 행동이 지연 없이 다른 사용자에게 전달되고 모든 사용자가 같은 상태의 화면을 공유해야 한다.

이 요구사항을 만족하지 못한다면 전자칠판은 단순히 내용을 공유하는 일반적인 게시판에 불과해진다.

그래서 전자칠판 서비스에서는 **안정적이고 확장 가능한 실시간 메시징 구조**가 필요했고 이를 위해 **WebSocket + Kafka** 기반의 실시간 메시징 아키텍처를 구성하게 되었다.

이 글에서는 실제 서비스에서 메시지가 어떤 흐름으로 전달되는지를 중심으로 전자칠판 서비스 내 실시간 메시징 처리가 어떻게 이루어지고 있는지 정리해보려 한다.

***

# 실시간 메시징 아키텍처 개요

전자칠판 서비스의 실시간 메시징은
WebSocket + Kafka를 중심으로 구성된 구조를 사용하고 있다.

![
kafka
](./img/kafka/kafka.jpeg)

전체 흐름을 단순화하면 다음과 같다.

1. 클라이언트(선생님/학생)는 WebSocket을 통해 서버와 연결된다.

2. 사용자의 행동(게시물 작성, 이동, 삭제 등)은 WebSocket을 통해 서버로 전달된다.

3. 서버는 해당 이벤트를 Kafka로 전달한다.

4. Kafka는 메시지를 모든 서버 인스턴스에 전달한다.

5. 각 서버는 자신에게 연결된 클라이언트에게 WebSocket으로 메시지를 다시 전파한다.

이 구조를 통해
특정 서버 인스턴스에 종속되지 않고,
여러 서버로 확장된 환경에서도 모든 사용자가 동일한 실시간 화면을 공유할 수 있다.